<!DOCTYPE html>
<html lang="zh-cn">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>js-parser</title>
</head>

<body>
  <script>
    const source = `
      function parser(s) {
        return new Promise(resolve => {
          setTimeout(resolve);
        })
      }
    `;

    const ast = []

    const regexp = /(function|return|new)|(\s+)|(\w+)|([\(\)\{\}=\>,;])/g
    const dictionary = ['keywords', 'whitespace', 'identifer', 'punctuator']
    let token = null

    function run() {
      do {
        token = regexp.exec(source)
        if (token) {
          for (let i = 0; i < 4; i++) {
            if (token[i + 1])
              console.log(dictionary[i] + ':' + token[i + 1]);
          }
        }
      } while (token);
    }
  </script>
</body>

</html>