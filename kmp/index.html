<script>
  function find2(source, pattern) {
    const next = generateNext(pattern)
    let j = -1
    for (let i = 0; i < source.length; i++) {
      if (source[i] === pattern[j < 0 ? 0 : j]) {
        j++
      } else {
        j = next[j] || 0
        if (source[i] === pattern[j]) j++
      }
      if (j === pattern.length - 1) return true
    }

    return false
  }

  function find1(source, pattern) {
    const next = generateNext(pattern)
    let j = 0
    for (let i = 0; i < source.length; i++) {
      if (source[i] === pattern[j]) {
        j++
      } else {
        rollback(i, j)
      }
      if (j === pattern.length) return true
    }

    function rollback(i, k) {
      if (j === 0) return
      j = next[k - 1] || 0
      if (source[i] === pattern[j]) j++
      else rollback(i, k - 1)
    }

    return false
  }

  function generateNext(pattern) {
    let j = 1;
    const next = Array(pattern.length).fill(0)
    for (let i = 0; i < pattern.length; i++) {
      if (pattern[i] === pattern[j]) {
        j++
        next[i] = j
      } else {
        j = 0
      }
    }
    return next
  }

  console.log(find1('abcababcabx', 'abcabx'));
  console.log(find1('abcdabcdabcxabcd', 'abcdabcxabcd'));
  console.log(find1('abcdabcdabcx', 'abcdabcx'));
  console.log(find1('abcxxyz', 'xy'));
  console.log(find1('abcxyz', 'xy'));
</script>